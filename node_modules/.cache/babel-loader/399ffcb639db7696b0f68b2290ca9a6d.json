{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Sinem Morzambak\\\\Desktop\\\\my-OBSS-proejct\\\\src\\\\context\\\\currentUser.jsx\",\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$();\n\nimport { createContext, useContext, useEffect, useReducer } from 'react';\nimport useFetch from '../hooks/useFetch';\nimport useStorage from '../hooks/useStorage';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  isLoading: false,\n  isLoggedIn: null,\n  currentUser: null\n};\n\nconst reducer = (state, action) => {\n  switch (action.type) {\n    case 'LOADING':\n      return { ...state,\n        isLoading: true\n      };\n\n    case 'SET_AUTHORIZED':\n      return { ...state,\n        isLoggedIn: true,\n        isLoading: false,\n        currentUser: action.payload\n      };\n\n    case 'SET_UNAUTHORIZED':\n      return { ...state,\n        isLoggedIn: false\n      };\n\n    case 'LOGOUT':\n      return { ...initialState,\n        isLoggedIn: false\n      };\n\n    default:\n      return {\n        state\n      };\n  }\n};\n\nconst newState = reducer(initialState, {\n  type: 'LOGOUT'\n});\nconst CurrentUserContext = /*#__PURE__*/createContext([{}, () => {}]);\n\nconst CurrentUserProvider = _ref => {\n  _s();\n\n  let {\n    children\n  } = _ref;\n  const value = useReducer(reducer, initialState);\n  return /*#__PURE__*/_jsxDEV(CurrentUserContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 49,\n    columnNumber: 9\n  }, this);\n};\n\n_s(CurrentUserProvider, \"HDl9A1duRDI+maTNi9v2R1p+EwQ=\");\n\n_c = CurrentUserProvider;\n\nconst CurrentUserChecker = _ref2 => {\n  _s2();\n\n  let {\n    children\n  } = _ref2;\n  const [{\n    response\n  }, doFetch] = useFetch('/user');\n  const [, dispatch] = useContext(CurrentUserContext);\n  const [token] = useStorage('token');\n  useEffect(() => {\n    if (!token) {\n      dispatch({\n        type: 'SET_UNAUTHORIZED'\n      });\n      return;\n    }\n\n    doFetch();\n    dispatch({\n      type: 'LOADING'\n    });\n  }, [token, doFetch, dispatch]);\n  useEffect(() => {\n    if (!response) {\n      return;\n    }\n\n    dispatch({\n      type: 'SET_AUTHORIZED',\n      payload: response.user\n    });\n  }, [dispatch, response]);\n  return children;\n};\n\n_s2(CurrentUserChecker, \"+j49cers02WPRNyv2qY6MYFAa7E=\", false, function () {\n  return [useFetch, useStorage];\n});\n\n_c2 = CurrentUserChecker;\nexport { CurrentUserContext, CurrentUserProvider, CurrentUserChecker };\n\nvar _c, _c2;\n\n$RefreshReg$(_c, \"CurrentUserProvider\");\n$RefreshReg$(_c2, \"CurrentUserChecker\");","map":{"version":3,"names":["createContext","useContext","useEffect","useReducer","useFetch","useStorage","initialState","isLoading","isLoggedIn","currentUser","reducer","state","action","type","payload","newState","CurrentUserContext","CurrentUserProvider","children","value","CurrentUserChecker","response","doFetch","dispatch","token","user"],"sources":["C:/Users/Sinem Morzambak/Desktop/my-OBSS-proejct/src/context/currentUser.jsx"],"sourcesContent":["import { createContext, useContext, useEffect, useReducer } from 'react'\r\nimport useFetch from '../hooks/useFetch'\r\nimport useStorage from '../hooks/useStorage'\r\n\r\nconst initialState = {\r\n\tisLoading: false,\r\n\tisLoggedIn: null,\r\n\tcurrentUser: null,\r\n}\r\n\r\nconst reducer = (state, action) => {\r\n\tswitch (action.type) {\r\n\t\tcase 'LOADING':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tisLoading: true,\r\n\t\t\t}\r\n\t\tcase 'SET_AUTHORIZED':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tisLoggedIn: true,\r\n\t\t\t\tisLoading: false,\r\n\t\t\t\tcurrentUser: action.payload,\r\n\t\t\t}\r\n\t\tcase 'SET_UNAUTHORIZED':\r\n\t\t\treturn {\r\n\t\t\t\t...state,\r\n\t\t\t\tisLoggedIn: false,\r\n\t\t\t}\r\n\t\tcase 'LOGOUT':\r\n\t\t\treturn {\r\n\t\t\t\t...initialState,\r\n\t\t\t\tisLoggedIn: false\r\n\t\t\t}\r\n\t\tdefault:\r\n\t\t\treturn {\r\n\t\t\t\tstate,\r\n\t\t\t}\r\n\t}\r\n}\r\n\r\nconst newState = reducer(initialState, { type: 'LOGOUT' })\r\n\r\nconst CurrentUserContext = createContext([{}, () => {\r\n}])\r\n\r\nconst CurrentUserProvider = ({ children }) => {\r\n\tconst value = useReducer(reducer, initialState)\r\n\treturn <CurrentUserContext.Provider value={value}>{children}</CurrentUserContext.Provider>\r\n}\r\n\r\nconst CurrentUserChecker = ({ children }) => {\r\n\tconst [{ response }, doFetch] = useFetch('/user')\r\n\tconst [, dispatch] = useContext(CurrentUserContext)\r\n\tconst [token] = useStorage('token')\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!token) {\r\n\t\t\tdispatch({ type: 'SET_UNAUTHORIZED' })\r\n\t\t\treturn\r\n\t\t}\r\n\r\n\t\tdoFetch()\r\n\t\tdispatch({ type: 'LOADING' })\r\n\t}, [token, doFetch, dispatch])\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tdispatch({ type: 'SET_AUTHORIZED', payload: response.user })\r\n\t}, [dispatch, response])\r\n\r\n\treturn children\r\n}\r\n\r\nexport { CurrentUserContext, CurrentUserProvider, CurrentUserChecker }\r\n"],"mappings":";;;;AAAA,SAASA,aAAT,EAAwBC,UAAxB,EAAoCC,SAApC,EAA+CC,UAA/C,QAAiE,OAAjE;AACA,OAAOC,QAAP,MAAqB,mBAArB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;;AAEA,MAAMC,YAAY,GAAG;EACpBC,SAAS,EAAE,KADS;EAEpBC,UAAU,EAAE,IAFQ;EAGpBC,WAAW,EAAE;AAHO,CAArB;;AAMA,MAAMC,OAAO,GAAG,CAACC,KAAD,EAAQC,MAAR,KAAmB;EAClC,QAAQA,MAAM,CAACC,IAAf;IACC,KAAK,SAAL;MACC,OAAO,EACN,GAAGF,KADG;QAENJ,SAAS,EAAE;MAFL,CAAP;;IAID,KAAK,gBAAL;MACC,OAAO,EACN,GAAGI,KADG;QAENH,UAAU,EAAE,IAFN;QAGND,SAAS,EAAE,KAHL;QAINE,WAAW,EAAEG,MAAM,CAACE;MAJd,CAAP;;IAMD,KAAK,kBAAL;MACC,OAAO,EACN,GAAGH,KADG;QAENH,UAAU,EAAE;MAFN,CAAP;;IAID,KAAK,QAAL;MACC,OAAO,EACN,GAAGF,YADG;QAENE,UAAU,EAAE;MAFN,CAAP;;IAID;MACC,OAAO;QACNG;MADM,CAAP;EAxBF;AA4BA,CA7BD;;AA+BA,MAAMI,QAAQ,GAAGL,OAAO,CAACJ,YAAD,EAAe;EAAEO,IAAI,EAAE;AAAR,CAAf,CAAxB;AAEA,MAAMG,kBAAkB,gBAAGhB,aAAa,CAAC,CAAC,EAAD,EAAK,MAAM,CACnD,CADwC,CAAD,CAAxC;;AAGA,MAAMiB,mBAAmB,GAAG,QAAkB;EAAA;;EAAA,IAAjB;IAAEC;EAAF,CAAiB;EAC7C,MAAMC,KAAK,GAAGhB,UAAU,CAACO,OAAD,EAAUJ,YAAV,CAAxB;EACA,oBAAO,QAAC,kBAAD,CAAoB,QAApB;IAA6B,KAAK,EAAEa,KAApC;IAAA,UAA4CD;EAA5C;IAAA;IAAA;IAAA;EAAA,QAAP;AACA,CAHD;;GAAMD,mB;;KAAAA,mB;;AAKN,MAAMG,kBAAkB,GAAG,SAAkB;EAAA;;EAAA,IAAjB;IAAEF;EAAF,CAAiB;EAC5C,MAAM,CAAC;IAAEG;EAAF,CAAD,EAAeC,OAAf,IAA0BlB,QAAQ,CAAC,OAAD,CAAxC;EACA,MAAM,GAAGmB,QAAH,IAAetB,UAAU,CAACe,kBAAD,CAA/B;EACA,MAAM,CAACQ,KAAD,IAAUnB,UAAU,CAAC,OAAD,CAA1B;EAEAH,SAAS,CAAC,MAAM;IACf,IAAI,CAACsB,KAAL,EAAY;MACXD,QAAQ,CAAC;QAAEV,IAAI,EAAE;MAAR,CAAD,CAAR;MACA;IACA;;IAEDS,OAAO;IACPC,QAAQ,CAAC;MAAEV,IAAI,EAAE;IAAR,CAAD,CAAR;EACA,CARQ,EAQN,CAACW,KAAD,EAAQF,OAAR,EAAiBC,QAAjB,CARM,CAAT;EAUArB,SAAS,CAAC,MAAM;IACf,IAAI,CAACmB,QAAL,EAAe;MACd;IACA;;IACDE,QAAQ,CAAC;MAAEV,IAAI,EAAE,gBAAR;MAA0BC,OAAO,EAAEO,QAAQ,CAACI;IAA5C,CAAD,CAAR;EACA,CALQ,EAKN,CAACF,QAAD,EAAWF,QAAX,CALM,CAAT;EAOA,OAAOH,QAAP;AACA,CAvBD;;IAAME,kB;UAC2BhB,Q,EAEhBC,U;;;MAHXe,kB;AAyBN,SAASJ,kBAAT,EAA6BC,mBAA7B,EAAkDG,kBAAlD"},"metadata":{},"sourceType":"module"}