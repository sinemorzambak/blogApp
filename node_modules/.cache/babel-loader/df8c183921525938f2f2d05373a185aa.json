{"ast":null,"code":"import _slicedToArray from\"C:/Users/Sinem Morzambak/Desktop/my-OBSS-proejct/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useContext,useEffect,useState}from'react';import{Link,useLocation,useNavigate}from'react-router-dom';import useFetch from'../../hooks/useFetch';import useStorage from'../../hooks/useStorage';import{CurrentUserContext}from'../../context/currentUser';import ErrorMessage from'../../components/ErrorMessage';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Auth=function Auth(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),email=_useState2[0],setEmail=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),username=_useState4[0],setUsername=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),password=_useState6[0],setPassword=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isSuccessSubmit=_useState8[0],setIsSuccessSubmit=_useState8[1];var _useStorage=useStorage('token'),_useStorage2=_slicedToArray(_useStorage,2),setToken=_useStorage2[1];var _useContext=useContext(CurrentUserContext),_useContext2=_slicedToArray(_useContext,2),dispatch=_useContext2[1];var location=useLocation();var navigate=useNavigate();var isLogin=location.pathname==='/login';var pageTitle=isLogin?'Sing in':'Sing up';var pageDesc=isLogin?'Need an account?':'Have an account?';var pageLink=isLogin?'/register':'/login';var apiUrl=isLogin?'/users/login':'/users';var _useFetch=useFetch(apiUrl),_useFetch2=_slicedToArray(_useFetch,2),_useFetch2$=_useFetch2[0],isLoading=_useFetch2$.isLoading,response=_useFetch2$.response,error=_useFetch2$.error,doFetch=_useFetch2[1];var handleSubmit=function handleSubmit(e){e.preventDefault();var user=isLogin?{email:email,password:password}:{email:email,password:password,username:username};doFetch({method:'post',data:{user:user}});};useEffect(function(){if(!response){return;}setToken(response.user.token);setIsSuccessSubmit(true);dispatch({type:'SET_AUTHORIZED',payload:response.user});if(isSuccessSubmit){return navigate('/');}},[response,setToken,navigate,isSuccessSubmit,dispatch]);return/*#__PURE__*/_jsx(\"div\",{className:\"auth-page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container page\",children:/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6 offset-md-3 col-xs-12\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-center\",children:pageTitle}),/*#__PURE__*/_jsx(\"p\",{className:\"text-center\",children:/*#__PURE__*/_jsx(Link,{to:pageLink,children:pageDesc})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[error&&/*#__PURE__*/_jsx(ErrorMessage,{error:error.errors}),/*#__PURE__*/_jsxs(\"fieldset\",{children:[!isLogin&&/*#__PURE__*/_jsx(\"fieldset\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{required:true,type:\"text\",className:\"form-control form-control-lg mt-3\",placeholder:\"Username\",value:username,onChange:function onChange(e){return setUsername(e.target.value);}})}),/*#__PURE__*/_jsx(\"fieldset\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{required:true,type:\"email\",className:\"form-control form-control-lg mt-3\",placeholder:\"Email\",value:email,onChange:function onChange(e){return setEmail(e.target.value);}})}),/*#__PURE__*/_jsx(\"fieldset\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"input\",{required:true,type:\"password\",className:\"form-control form-control-lg mt-3\",placeholder:\"Password\",value:password,onChange:function onChange(e){return setPassword(e.target.value);}})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-primary mt-3\",type:\"submit\",disabled:isLoading,children:pageTitle})]})]})]})})})});};export default Auth;","map":{"version":3,"names":["React","useContext","useEffect","useState","Link","useLocation","useNavigate","useFetch","useStorage","CurrentUserContext","ErrorMessage","Auth","email","setEmail","username","setUsername","password","setPassword","isSuccessSubmit","setIsSuccessSubmit","setToken","dispatch","location","navigate","isLogin","pathname","pageTitle","pageDesc","pageLink","apiUrl","isLoading","response","error","doFetch","handleSubmit","e","preventDefault","user","method","data","token","type","payload","errors","target","value"],"sources":["C:/Users/Sinem Morzambak/Desktop/my-OBSS-proejct/src/pages/auth/Auth.jsx"],"sourcesContent":["import React, { useContext, useEffect, useState } from 'react'\r\nimport { Link, useLocation, useNavigate } from 'react-router-dom'\r\nimport useFetch from '../../hooks/useFetch'\r\nimport useStorage from '../../hooks/useStorage'\r\nimport { CurrentUserContext } from '../../context/currentUser'\r\nimport ErrorMessage from '../../components/ErrorMessage'\r\n\r\nconst Auth = () => {\r\n\tconst [email, setEmail] = useState('')\r\n\tconst [username, setUsername] = useState('')\r\n\tconst [password, setPassword] = useState('')\r\n\r\n\tconst [isSuccessSubmit, setIsSuccessSubmit] = useState(false)\r\n\tconst [, setToken] = useStorage('token')\r\n\tconst [, dispatch] = useContext(CurrentUserContext)\r\n\r\n\tconst location = useLocation()\r\n\tconst navigate = useNavigate()\r\n\r\n\tconst isLogin = location.pathname === '/login'\r\n\tconst pageTitle = isLogin ? 'Sing in' : 'Sing up'\r\n\tconst pageDesc = isLogin ? 'Need an account?' : 'Have an account?'\r\n\tconst pageLink = isLogin ? '/register' : '/login'\r\n\r\n\tconst apiUrl = isLogin ? '/users/login' : '/users'\r\n\tconst [{ isLoading, response, error }, doFetch] = useFetch(apiUrl)\r\n\r\n\tconst handleSubmit = (e) => {\r\n\t\te.preventDefault()\r\n\t\tconst user = isLogin ? { email, password } : { email, password, username }\r\n\r\n\t\tdoFetch({\r\n\t\t\tmethod: 'post',\r\n\t\t\tdata: {\r\n\t\t\t\tuser,\r\n\t\t\t},\r\n\t\t})\r\n\t}\r\n\r\n\tuseEffect(() => {\r\n\t\tif (!response) {\r\n\t\t\treturn\r\n\t\t}\r\n\t\tsetToken(response.user.token)\r\n\t\tsetIsSuccessSubmit(true)\r\n\t\tdispatch({ type: 'SET_AUTHORIZED', payload: response.user })\r\n\t\tif (isSuccessSubmit) {\r\n\t\t\treturn navigate('/')\r\n\t\t}\r\n\t}, [response, setToken, navigate, isSuccessSubmit, dispatch])\r\n\r\n\treturn (\r\n\t\t<div className='auth-page'>\r\n\t\t\t<div className='container page'>\r\n\t\t\t\t<div className='row'>\r\n\t\t\t\t\t<div className='col-md-6 offset-md-3 col-xs-12'>\r\n\t\t\t\t\t\t<h1 className='text-center'>{pageTitle}</h1>\r\n\t\t\t\t\t\t<p className='text-center'>\r\n\t\t\t\t\t\t\t<Link to={pageLink}>{pageDesc}</Link>\r\n\t\t\t\t\t\t</p>\r\n\t\t\t\t\t\t<form onSubmit={handleSubmit}>\r\n\t\t\t\t\t\t\t{error && <ErrorMessage error={error.errors} />}\r\n\t\t\t\t\t\t\t<fieldset>\r\n\t\t\t\t\t\t\t\t{!isLogin && (\r\n\t\t\t\t\t\t\t\t\t<fieldset className='form-group'>\r\n\t\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\t\ttype='text'\r\n\t\t\t\t\t\t\t\t\t\t\tclassName='form-control form-control-lg mt-3'\r\n\t\t\t\t\t\t\t\t\t\t\tplaceholder='Username'\r\n\t\t\t\t\t\t\t\t\t\t\tvalue={username}\r\n\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setUsername(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t<fieldset className='form-group'>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\ttype='email'\r\n\t\t\t\t\t\t\t\t\t\tclassName='form-control form-control-lg mt-3'\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Email'\r\n\t\t\t\t\t\t\t\t\t\tvalue={email}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setEmail(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t\t\t\t\t\t<fieldset className='form-group'>\r\n\t\t\t\t\t\t\t\t\t<input\r\n\t\t\t\t\t\t\t\t\t\trequired\r\n\t\t\t\t\t\t\t\t\t\ttype='password'\r\n\t\t\t\t\t\t\t\t\t\tclassName='form-control form-control-lg mt-3'\r\n\t\t\t\t\t\t\t\t\t\tplaceholder='Password'\r\n\t\t\t\t\t\t\t\t\t\tvalue={password}\r\n\t\t\t\t\t\t\t\t\t\tonChange={(e) => setPassword(e.target.value)}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t\t\t\t\t\t<button className='btn btn-primary mt-3' type='submit' disabled={isLoading}>\r\n\t\t\t\t\t\t\t\t\t{pageTitle}\r\n\t\t\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t\t</fieldset>\r\n\t\t\t\t\t\t</form>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t)\r\n}\r\n\r\nexport default Auth\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}